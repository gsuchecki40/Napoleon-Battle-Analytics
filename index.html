<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Napoleon — Battle Analytics</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  :root {
    --gold:     #C9A84C;
    --gold-dim: #8B6914;
    --red:      #8B1A1A;
    --red-bright: #C0392B;
    --cream:    #F2E8D5;
    --ink:      #0E0B07;
    --ink-mid:  #1A1510;
    --ink-light:#2A2218;
    --steel:    #4A5568;
    --text-dim: #8B7D6B;
    --border:   rgba(201,168,76,0.2);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--ink);
    color: var(--cream);
    font-family: 'Crimson Text', Georgia, serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Subtle noise texture overlay */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
    opacity: 0.4;
  }

  .page { position: relative; z-index: 1; max-width: 1200px; margin: 0 auto; padding: 60px 40px; }

  /* ── Header ── */
  header {
    text-align: center;
    padding-bottom: 60px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 70px;
    position: relative;
  }

  header::after {
    content: '✦';
    display: block;
    color: var(--gold);
    font-size: 14px;
    margin-top: 24px;
    letter-spacing: 8px;
  }

  .eyebrow {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    letter-spacing: 4px;
    color: var(--gold);
    text-transform: uppercase;
    margin-bottom: 16px;
  }

  h1 {
    font-family: 'Cinzel', serif;
    font-size: clamp(42px, 6vw, 72px);
    font-weight: 900;
    line-height: 1;
    color: var(--cream);
    letter-spacing: -1px;
  }

  h1 span {
    color: var(--gold);
  }

  .subtitle {
    margin-top: 16px;
    font-size: 18px;
    font-style: italic;
    color: var(--text-dim);
    letter-spacing: 0.5px;
  }

  /* ── Section titles ── */
  .section-title {
    font-family: 'Cinzel', serif;
    font-size: 13px;
    letter-spacing: 5px;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 32px;
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .section-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  section { margin-bottom: 80px; }

  /* ── Stat cards row ── */
  .stat-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 2px;
    margin-bottom: 80px;
  }

  .stat-card {
    background: var(--ink-mid);
    border: 1px solid var(--border);
    padding: 32px 24px;
    text-align: center;
    position: relative;
    overflow: hidden;
    transition: border-color 0.3s;
  }

  .stat-card:hover { border-color: var(--gold); }

  .stat-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    opacity: 0;
    transition: opacity 0.3s;
  }
  .stat-card:hover::before { opacity: 1; }

  .stat-value {
    font-family: 'Cinzel', serif;
    font-size: 48px;
    font-weight: 700;
    color: var(--gold);
    line-height: 1;
    margin-bottom: 8px;
  }

  .stat-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-dim);
  }

  .stat-context {
    font-size: 13px;
    font-style: italic;
    color: var(--text-dim);
    margin-top: 8px;
  }

  /* ── General comparison bars ── */
  .general-table { display: flex; flex-direction: column; gap: 3px; }

  .general-row {
    display: grid;
    grid-template-columns: 160px 1fr 80px;
    align-items: center;
    gap: 16px;
    padding: 10px 0;
    border-bottom: 1px solid rgba(201,168,76,0.07);
    transition: background 0.2s;
  }
  .general-row:hover { background: rgba(201,168,76,0.03); }

  .general-name {
    font-family: 'Cinzel', serif;
    font-size: 12px;
    letter-spacing: 1px;
    color: var(--cream);
    text-align: right;
    padding-right: 8px;
  }
  .general-name.napoleon { color: var(--gold); }

  .bar-track {
    height: 28px;
    background: var(--ink-light);
    border: 1px solid rgba(255,255,255,0.04);
    position: relative;
    overflow: hidden;
  }

  .bar-fill {
    height: 100%;
    background: var(--steel);
    transition: width 1.2s cubic-bezier(0.16, 1, 0.3, 1);
    position: relative;
  }
  .bar-fill.napoleon-bar {
    background: linear-gradient(90deg, var(--gold-dim), var(--gold));
  }
  .bar-fill::after {
    content: '';
    position: absolute;
    top: 0; right: 0;
    width: 2px; height: 100%;
    background: rgba(255,255,255,0.3);
  }

  .bar-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--text-dim);
    text-align: right;
    white-space: nowrap;
  }
  .bar-value.napoleon-val { color: var(--gold); }

  /* ── Comparison metric tabs ── */
  .metric-tabs {
    display: flex;
    gap: 2px;
    margin-bottom: 32px;
    border-bottom: 1px solid var(--border);
    padding-bottom: 0;
  }

  .metric-tab {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    padding: 10px 18px;
    cursor: pointer;
    color: var(--text-dim);
    border-bottom: 2px solid transparent;
    margin-bottom: -1px;
    transition: all 0.2s;
    background: none;
    border-top: none;
    border-left: none;
    border-right: none;
  }

  .metric-tab:hover { color: var(--cream); }
  .metric-tab.active { color: var(--gold); border-bottom-color: var(--gold); }

  .metric-panel { display: none; }
  .metric-panel.active { display: block; }

  /* ── Head to head ── */
  .matchup-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
  }

  .matchup-card {
    background: var(--ink-mid);
    border: 1px solid var(--border);
    padding: 28px;
    position: relative;
  }

  .matchup-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
  }

  .matchup-gen {
    font-family: 'Cinzel', serif;
    font-size: 13px;
    letter-spacing: 1px;
  }

  .matchup-gen.a { color: var(--gold); }
  .matchup-gen.b { color: #5B8DB8; text-align: right; }

  .vs-badge {
    font-family: 'Cinzel', serif;
    font-size: 10px;
    color: var(--text-dim);
    letter-spacing: 2px;
    border: 1px solid var(--border);
    padding: 4px 8px;
  }

  .h2h-bar-container { margin-bottom: 16px; }

  .h2h-context {
    font-family: 'JetBrains Mono', monospace;
    font-size: 9px;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 8px;
  }

  .h2h-bar {
    height: 36px;
    display: flex;
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.04);
    position: relative;
  }

  .h2h-seg-a {
    background: linear-gradient(90deg, var(--gold-dim), var(--gold));
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Cinzel', serif;
    font-size: 11px;
    font-weight: 700;
    color: var(--ink);
    transition: width 1s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .h2h-seg-draw {
    background: var(--ink-light);
    border-left: 1px solid rgba(255,255,255,0.08);
    border-right: 1px solid rgba(255,255,255,0.08);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'JetBrains Mono', monospace;
    font-size: 9px;
    color: var(--text-dim);
  }

  .h2h-seg-b {
    background: linear-gradient(90deg, #2C5F8A, #5B8DB8);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Cinzel', serif;
    font-size: 11px;
    font-weight: 700;
    color: white;
    transition: width 1s cubic-bezier(0.16, 1, 0.3, 1);
  }

  /* ── Cluster distribution ── */
  .cluster-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
  }

  .cluster-card {
    background: var(--ink-mid);
    border: 1px solid var(--border);
    padding: 20px 16px;
    position: relative;
    overflow: hidden;
  }

  .cluster-card::before {
    content: '';
    position: absolute;
    bottom: 0; left: 0; right: 0;
    background: var(--gold);
    opacity: 0.15;
    transition: height 1s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .cluster-name {
    font-family: 'Cinzel', serif;
    font-size: 10px;
    letter-spacing: 1px;
    color: var(--cream);
    margin-bottom: 16px;
    line-height: 1.4;
    position: relative;
    z-index: 1;
  }

  .cluster-pct {
    font-family: 'Cinzel', serif;
    font-size: 32px;
    font-weight: 700;
    color: var(--gold);
    line-height: 1;
    position: relative;
    z-index: 1;
  }

  .cluster-win {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    color: var(--text-dim);
    margin-top: 6px;
    position: relative;
    z-index: 1;
  }

  .cluster-win span { color: var(--cream); }

  /* ── Divider ── */
  .ornamental-divider {
    text-align: center;
    color: var(--gold-dim);
    font-size: 12px;
    letter-spacing: 12px;
    margin: 60px 0;
    opacity: 0.6;
  }

  /* ── Footer ── */
  footer {
    border-top: 1px solid var(--border);
    padding-top: 32px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .footer-text {
    font-family: 'JetBrains Mono', monospace;
    font-size: 10px;
    letter-spacing: 2px;
    color: var(--text-dim);
    text-transform: uppercase;
  }

  /* ── Animations ── */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .animate-in {
    opacity: 0;
    animation: fadeUp 0.8s ease forwards;
  }

  .delay-1 { animation-delay: 0.1s; }
  .delay-2 { animation-delay: 0.2s; }
  .delay-3 { animation-delay: 0.3s; }
  .delay-4 { animation-delay: 0.4s; }
  .delay-5 { animation-delay: 0.5s; }

  @media (max-width: 768px) {
    .stat-grid { grid-template-columns: repeat(2, 1fr); }
    .matchup-grid { grid-template-columns: 1fr; }
    .cluster-grid { grid-template-columns: repeat(2, 1fr); }
    .general-row { grid-template-columns: 120px 1fr 60px; }
  }
</style>
</head>
<body>
<div class="page">

  <!-- ── Header ── -->
  <header class="animate-in">
    <div class="eyebrow">CDB90 Historical Battle Database · 660 Engagements · 1600–1973</div>
    <h1>NAPOLÉON <span>I</span></h1>
    <div class="subtitle">A statistical analysis of military genius across history's greatest commanders</div>
  </header>

  <!-- ── Key stats ── -->
  <div class="section-title animate-in delay-1">Career Overview</div>
  <div class="stat-grid animate-in delay-2">
    <div class="stat-card">
      <div class="stat-value">25</div>
      <div class="stat-label">Battles Recorded</div>
      <div class="stat-context">Most in dataset</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">80%</div>
      <div class="stat-label">Win Rate</div>
      <div class="stat-context">20 victories</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">6.92</div>
      <div class="stat-label">Avg Achievement</div>
      <div class="stat-context">Scale of 0–10</div>
    </div>
    <div class="stat-card">
      <div class="stat-value">12%</div>
      <div class="stat-label">As Underdog</div>
      <div class="stat-context">Lowest in peer group</div>
    </div>
  </div>

  <!-- ── General comparison ── -->
  <section class="animate-in delay-2">
    <div class="section-title">Peer Comparison</div>

    <div class="metric-tabs">
      <button class="metric-tab active" onclick="switchTab(this, 'winrate')">Win Rate</button>
      <button class="metric-tab" onclick="switchTab(this, 'ach')">Achievement</button>
      <button class="metric-tab" onclick="switchTab(this, 'intensity')">Casualty Intensity</button>
      <button class="metric-tab" onclick="switchTab(this, 'underdog')">Underdog Rate</button>
    </div>

    <!-- Win Rate -->
    <div id="tab-winrate" class="metric-panel active">
      <div class="general-table" id="bars-winrate"></div>
    </div>

    <!-- Achievement -->
    <div id="tab-ach" class="metric-panel">
      <div class="general-table" id="bars-ach"></div>
    </div>

    <!-- Casualty Intensity -->
    <div id="tab-intensity" class="metric-panel">
      <div class="general-table" id="bars-intensity"></div>
    </div>

    <!-- Underdog Rate -->
    <div id="tab-underdog" class="metric-panel">
      <div class="general-table" id="bars-underdog"></div>
    </div>
  </section>

  <!-- ── Cluster distribution ── -->
  <section class="animate-in delay-3">
    <div class="section-title">Battle Type Distribution</div>
    <div class="cluster-grid" id="cluster-grid"></div>
  </section>

  <div class="ornamental-divider">✦ ✦ ✦</div>

  <!-- ── Head to head ── -->
  <section class="animate-in delay-4">
    <div class="section-title">Monte Carlo Head-to-Head  ·  100,000 Simulations</div>
    <div class="matchup-grid" id="matchup-grid"></div>
  </section>

  <!-- ── Footer ── -->
  <footer class="animate-in delay-5">
    <div class="footer-text">Source: CDB90 Battle Database</div>
    <div class="footer-text">ML Clustering · K-Means k=8 · UMAP Projection</div>
    <div class="footer-text">Monte Carlo · Empirical ACH Distributions</div>
  </footer>

</div>

<script>
// ── Data ──────────────────────────────────────────────────────────────────────
const generals = [
  { name: 'NAPOLEON I',      winRate: 80.0, ach: 6.92, intensity: 0.2028, underdog: 12.0, battles: 25, isNapoleon: true },
  { name: 'WELLINGTON',      winRate:100.0, ach: 7.00, intensity: 0.1300, underdog: 33.3, battles: 6  },
  { name: 'TURENNE',         winRate: 83.3, ach: 7.17, intensity: 0.2142, underdog: 16.7, battles: 6  },
  { name: 'JACKSON',         winRate: 83.3, ach: 7.17, intensity: 0.1388, underdog: 33.3, battles: 6  },
  { name: 'FREDERICK II',    winRate: 78.6, ach: 7.43, intensity: 0.2304, underdog: 28.6, battles: 14 },
  { name: 'GRANT',           winRate: 62.5, ach: 6.12, intensity: 0.1445, underdog: 37.5, battles: 8  },
  { name: 'WASHINGTON',      winRate: 60.0, ach: 6.40, intensity: 0.0856, underdog:  0.0, battles: 5  },
  { name: 'LEE',             winRate: 50.0, ach: 6.33, intensity: 0.1453, underdog:  0.0, battles: 12 },
  { name: 'ARCHDUKE CHARLES',winRate: 42.9, ach: 5.29, intensity: 0.1436, underdog: 14.3, battles: 7  },
];

const clusters = [
  { name: 'Large-Scale\nAttritional',        pct: 48, winRate: 83, n: 12 },
  { name: 'High-Intensity\nDefensive',        pct: 16, winRate: 75, n:  4 },
  { name: 'Massive\nSet-Piece',               pct: 24, winRate: 67, n:  6 },
  { name: 'Decisive\nPursuit',                pct:  4, winRate: 100,n:  1 },
  { name: 'High-Intensity\nOffensive',        pct:  4, winRate: 100,n:  1 },
  { name: 'Small-Scale\nEngagement',          pct:  0, winRate: 0,  n:  0 },
  { name: 'Failed\nAssault',                  pct:  4, winRate:  0, n:  1 },
  { name: 'Operational-Scale\nAnnihilation',  pct:  0, winRate: 0,  n:  0 },
];

const matchups = [
  {
    a: 'NAPOLEON I', b: 'WELLINGTON',
    contexts: [
      { label: 'Large-Scale Attritional', wa: 48.6, draw: 19.8, wb: 31.6 },
      { label: 'OVERALL',                 wa: 48.6, draw:  0.0, wb: 51.4 },
    ]
  },
  {
    a: 'NAPOLEON I', b: 'LEE',
    contexts: [
      { label: 'Large-Scale Attritional', wa: 53.8, draw: 14.9, wb: 31.3 },
      { label: 'Massive Set-Piece',       wa: 49.9, draw:  0.0, wb: 50.1 },
      { label: 'OVERALL',                 wa: 52.7, draw:  0.0, wb: 47.3 },
    ]
  },
  {
    a: 'NAPOLEON I', b: 'JACKSON',
    contexts: [
      { label: 'High-Intensity Defensive',wa: 67.0, draw:  0.0, wb: 33.0 },
      { label: 'OVERALL',                 wa: 67.0, draw:  0.0, wb: 33.0 },
    ]
  },
  {
    a: 'GRANT', b: 'LEE',
    contexts: [
      { label: 'Large-Scale Attritional', wa: 39.6, draw: 15.9, wb: 44.5 },
      { label: 'OVERALL',                 wa: 39.6, draw:  0.0, wb: 60.4 },
    ]
  },
];

// ── Render bars ───────────────────────────────────────────────────────────────
function renderBars(containerId, metric, maxVal, fmt) {
  const sorted = [...generals].sort((a, b) => b[metric] - a[metric]);
  const container = document.getElementById(containerId);
  container.innerHTML = '';

  sorted.forEach((g, i) => {
    const pct = (g[metric] / maxVal) * 100;
    const row = document.createElement('div');
    row.className = 'general-row';
    row.style.animationDelay = `${i * 0.05}s`;
    row.innerHTML = `
      <div class="general-name ${g.isNapoleon ? 'napoleon' : ''}">${g.name}</div>
      <div class="bar-track">
        <div class="bar-fill ${g.isNapoleon ? 'napoleon-bar' : ''}" style="width:0%" data-target="${pct}"></div>
      </div>
      <div class="bar-value ${g.isNapoleon ? 'napoleon-val' : ''}">${fmt(g[metric])}</div>
    `;
    container.appendChild(row);
  });

  // Animate bars after small delay
  setTimeout(() => {
    container.querySelectorAll('.bar-fill').forEach(el => {
      el.style.width = el.dataset.target + '%';
    });
  }, 100);
}

function switchTab(btn, metric) {
  document.querySelectorAll('.metric-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.metric-panel').forEach(p => p.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('tab-' + metric).classList.add('active');
  renderCurrentTab(metric);
}

function renderCurrentTab(metric) {
  const configs = {
    winrate:   { id: 'bars-winrate',   key: 'winRate',   max: 100,   fmt: v => v.toFixed(0) + '%' },
    ach:       { id: 'bars-ach',       key: 'ach',       max: 10,    fmt: v => v.toFixed(2)       },
    intensity: { id: 'bars-intensity', key: 'intensity', max: 0.25,  fmt: v => v.toFixed(4)       },
    underdog:  { id: 'bars-underdog',  key: 'underdog',  max: 40,    fmt: v => v.toFixed(1) + '%' },
  };
  const c = configs[metric];
  renderBars(c.id, c.key, c.max, c.fmt);
}

// ── Render clusters ───────────────────────────────────────────────────────────
function renderClusters() {
  const grid = document.getElementById('cluster-grid');
  clusters.forEach(c => {
    if (c.n === 0) return;
    const card = document.createElement('div');
    card.className = 'cluster-card';
    card.style.setProperty('--bar-h', c.pct + '%');
    card.innerHTML = `
      <div class="cluster-name">${c.name.replace('\n', '<br>')}</div>
      <div class="cluster-pct">${c.pct}%</div>
      <div class="cluster-win">Win rate: <span>${c.winRate}%</span> · n=${c.n}</div>
    `;
    card.querySelector('.cluster-name').innerHTML = c.name.replace('\n', '<br>');
    // Animate the fill bar
    card.querySelector('::before');
    card.style.position = 'relative';
    const fill = document.createElement('div');
    fill.style.cssText = `position:absolute;bottom:0;left:0;right:0;height:0;background:var(--gold);opacity:0.12;transition:height 1.2s cubic-bezier(0.16,1,0.3,1);`;
    card.appendChild(fill);
    setTimeout(() => { fill.style.height = c.pct + '%'; }, 300);
    grid.appendChild(card);
  });
}

// ── Render matchups ───────────────────────────────────────────────────────────
function renderMatchups() {
  const grid = document.getElementById('matchup-grid');
  matchups.forEach(m => {
    const card = document.createElement('div');
    card.className = 'matchup-card';

    const isNapA = m.a === 'NAPOLEON I';
    const isNapB = m.b === 'NAPOLEON I';

    let contextsHTML = m.contexts.map(c => `
      <div class="h2h-bar-container">
        <div class="h2h-context">${c.label}</div>
        <div class="h2h-bar">
          <div class="h2h-seg-a" style="width:${c.wa}%" data-w="${c.wa}">${c.wa >= 8 ? c.wa.toFixed(1)+'%' : ''}</div>
          ${c.draw > 0 ? `<div class="h2h-seg-draw" style="width:${c.draw}%" data-w="${c.draw}">${c.draw >= 5 ? 'DRAW' : ''}</div>` : ''}
          <div class="h2h-seg-b" style="width:${c.wb}%" data-w="${c.wb}">${c.wb >= 8 ? c.wb.toFixed(1)+'%' : ''}</div>
        </div>
      </div>
    `).join('');

    card.innerHTML = `
      <div class="matchup-header">
        <div class="matchup-gen a">${m.a}</div>
        <div class="vs-badge">VS</div>
        <div class="matchup-gen b">${m.b}</div>
      </div>
      ${contextsHTML}
    `;
    grid.appendChild(card);
  });
}

// ── Init ──────────────────────────────────────────────────────────────────────
renderCurrentTab('winrate');
renderClusters();
renderMatchups();
</script>
</body>
</html>